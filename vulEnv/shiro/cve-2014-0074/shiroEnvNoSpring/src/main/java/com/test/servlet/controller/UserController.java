package com.test.servlet.controller;


import com.test.shiro.ShiroUtil;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

@Controller
public class UserController {

    /**如果login submission 的路径与login page 请求路径一致 == loginUrl（请求方法不一致）&& 配置 loginUrl = authc
     * 则会进入FormedAuthenticationFilter.super.executeLogin()
     * 在这这里面会自动读取username,password,rememberMe(如果为ture,则直接生成cookie字段rememberMe，存储principal).这些参数名子可以通过配置文件改变
     *
     *
     * 如此就不用手动调用ShiroUtil.login(),
     * https://shiro.apache.org/web.html#remember_me_services
     *
     *
     * @return
     */

//    @PostMapping("/doLogin")
//    public String doLoginPage(@RequestParam("username") String username, @RequestParam("password") String password, @RequestParam(name="rememberme", defaultValue="") String rememberMe){
//        if(ShiroUtil.login(username, password)){
//            if(ShiroUtil.hasRole("admin")){
//                return "redirect:/admin";
//            } else if (ShiroUtil.hasRole("user")) {
//                return "redirect:/user";
//            }
//        }
//        return "redirect:/unauth";
//    }

    @GetMapping(value={"/login"})
    public String loginPage() throws Exception {

        return "login";
    }


    @GetMapping("/admin")
    public String adminPage() throws Exception {
        return "admin";
    }


    @GetMapping("/user")
    public String userPage() throws Exception {
        return "user";
    }

    @GetMapping("/aunth")
    public String aunthPage() throws Exception {
        return "aunth";
    }

    @GetMapping("/")
    public String indexPage() throws Exception {
        return "index";
    }



}



